---
title: vue2.0ä¸€èµ·åœ¨æ‡µé€¼çš„æµ·æ´‹é‡Œè¶Šé™·è¶Šæ·±ï¼ˆå…­ï¼‰
date: 2016-12-18 22:47:23
tags: [vuejs, vue-router]
---
### å‰è¨€
æœ¬æ–‡ç« ç³»åˆ—ï¼š[vue2.0ä¸€èµ·åœ¨æ‡µé€¼çš„æµ·æ´‹é‡Œè¶Šé™·è¶Šæ·± (http://leenty.com/tags/vuejs/)](http://leenty.com/tags/vuejs/)
[æ¼”ç¤ºåœºåœ°vue2.0 Demo](http://vue2.leenty.com),è¿™æ˜¯[æºç åœ°å€](https://github.com/leenty/vue2),è§‰å¾—é è°±çš„è¯æ¬¢è¿åŠ æ˜Ÿè·Ÿéš,æœ‰é—®é¢˜æ¬¢è¿è¯„è®ºå’ŒæŒ‡æ­£ğŸ˜ƒ

åœ¨vueå¼€å‘SPAåº”ç”¨çš„è¿‡ç¨‹ä¸­ï¼Œå¤šæ•°æƒ…å†µä¸‹æˆ‘ä»¬éœ€è¦è§£å†³ä¸€ä¸ªé—®é¢˜
å°±æ˜¯åœ¨è·¯ç”±è·³è½¬çš„è¿‡ç¨‹ä¸­éœ€è¦æ›´æ–°ä½ SPAåº”ç”¨çš„`title` ï¼Œ
è¿™ä¸€èŠ‚ä¸è¯´å…¶ä»–ï¼Œå°±å±•ç¤ºå¦‚ä½•ä½¿ç”¨`vue-router`çš„**å¯¼èˆªé’©å­**å»è§£å†³è¿™ä¹ˆä¸€ä¸ªé—®é¢˜ã€‚
æ¥ä¸‹æ¥å°±æ„‰å¿«çš„å»ç©è€å•¦ï¼
![çº¢çº¢ç«ç«æææƒšæƒš](http://www.leenty.com/img/vue/huaji_ld.jpg)

### æ­£æ–‡
å¥½çš„ï¼Œä»‹ç»ä¸‹èƒŒæ™¯ï¼Œæˆ‘æœ‰è¿™ä¹ˆä¸€ä¸ª[åšå®¢çš„demo](http://vue2.leenty.com)ï¼Œé‡Œé¢æœ‰å¤šä¸ªç‰ˆå—ï¼Œæ¯ä¸ªç‰ˆå—æœ‰ç€ä¸åŒçš„åç§°(`title`)
å…ˆçœ‹ä¸€ä¸‹Demoçš„è·¯ç”±ç»“æ„
```
vue2.leenty.com
â”œâ”€â”€ home                # é¦–é¡µç‰ˆå—
â”œâ”€â”€ article             # æ–‡ç« ç‰ˆå—
â”‚   â”œâ”€â”€ vue2-1            # å…·ä½“æ–‡ç« ä¸€
â”‚   â”œâ”€â”€ vue2-2            # å…·ä½“æ–‡ç« äºŒ
â”‚   â”œâ”€â”€ vue2-3            # å…·ä½“æ–‡ç« ä¸‰
â”‚   â”œâ”€â”€ vue2-4            # å…·ä½“æ–‡ç« å››
â”‚   â”œâ”€â”€ vue2-5            # å…·ä½“æ–‡ç« äº”
â”‚   â””â”€â”€ vue2-6            # å…·ä½“æ–‡ç« å…­
â””â”€â”€ demo                # æ¼”ç¤ºç‰ˆå—
    â””â”€â”€ demo-1            # å…·ä½“æ¼”ç¤ºä¸€
```
å¥½çš„ï¼Œæ¥ä¸‹æ¥è¦å®ç°çš„æ˜¯åœ¨åˆ‡æ¢è·¯ç”±çš„æ—¶å€™åŒæ—¶çš„å»åˆ‡æ¢ä½ é¡µé¢çš„`title`

#### æ€è·¯
è¿™é‡Œæ€è·¯æ˜¯ä½¿ç”¨`vue-router`çš„è·¯ç”±å…¨å±€å¯¼èˆªé’©å­å»è§£å†³è¿™ä¸ªé—®é¢˜
åœ¨è·¯ç”±å¯¹è±¡é‡Œæ·»åŠ ä¸€ä¸ª`title`å­—æ®µä»¥ä¾›è·¯ç”±å…¨å±€å¯¼èˆªé’©å­è¯»å–å¹¶æ›´æ–°é¡µé¢`title`

#### é…ç½®è·¯ç”±
æ‰€ä»¥ç¬¬ä¸€æ­¥ï¼Œå…ˆåœ¨è·¯ç”±å¯¹è±¡é‡Œæ·»åŠ è¿™ä¸€ä¸ªå­—æ®µã€‚
æ‰“å¼€`src/routes.js`([æºæ–‡ä»¶åœ°å€ï¼šhttps://github.com/leenty/vue2/blob/master/src/routes.js](https://github.com/leenty/vue2/blob/master/src/routes.js))
**ï¼ˆæ³¨æ„æ˜¯`routes.js`,è¿™æ˜¯å’±ç”¨æ¥å­˜æ”¾è·¯ç”±å¯¹è±¡çš„æ–‡ä»¶ï¼‰**
åœ¨åŸæœ‰æ•°æ®çš„åŸºç¡€ä¸Šæ·»åŠ `title`
è¿™é‡Œå…¶å®vue1.0å’Œvue2.0çš„å®ç°æ˜¯å·®ä¸å¤šçš„ï¼Œæ‰€ä»¥vue1.0ä¹Ÿæ˜¯å¯ä»¥ä½¿ç”¨çš„ã€‚
vue2.0è·¯ç”±å¯¹è±¡æä¾›äº†ä¸€ä¸ª`meta`å­—æ®µæ¥ç»™ä½ å­˜æ”¾ä¸€äº›å…¶ä»–ä¿¡æ¯ï¼Œæ‰€ä»¥è¿™é‡Œå°±å¯ä»¥ç”¨æ¥å­˜æ”¾`title`
vue1.0çš„è¯æ˜¯æ²¡æœ‰è¿™ä¸ªå­—æ®µçš„ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ä¸`path`å¹³çº§ã€‚
å…·ä½“å¦‚ä¸‹ï¼š
```js
const routes = [
  {
    name: 'Home',
    path: '/',
    meta: {
      title: 'home' // ä¸»é¡µçš„titleä¸ºhome
    },
    component: require('./components/Home.vue')
  },
  {
    name: 'Article',
    path: '/article',
    meta: {
      title: 'article' // æ–‡ç« æ¨¡å—ç›¸åº”çš„titleä¸ºarticle
    },
    component: require('./components/Article.vue'),
    children: [
      {
        name: 'vue2_1',
        path: '/article/vue2_1',
        meta: {
          title: 'vue2.0ä¸€èµ·åœ¨æ‡µé€¼çš„æµ·æ´‹é‡Œè¶Šé™·è¶Šæ·±ï¼ˆä¸€ï¼‰' // å­è·¯ç”±ä¹Ÿæ˜¯ä¸€æ ·çš„é“ç†
        },
        component: require('./md/articles/vue2-1.md')
      },
      // ... å­è·¯ç”±å’Œçˆ¶è·¯ç”±éƒ½å·®ä¸å¤šï¼Œæ‰€ä»¥åé¢çš„å°±çœç•¥äº†
    ]
  },
  {
    name: 'Demo',
    path: '/demo',
    meta: {
      title: 'demo' // æ¼”ç¤ºæ¨¡å—titleä¸ºdemo
    },
    component: require('./components/Demo.vue'),
    children: [
      {
        name: 'DemoVuexState',
        path: 'vuex_state',
        meta: {
          title: 'vuexæ¼”ç¤º'
        },
        component: require('./components/DemoVuexState.vue')
      }
    ]
  }
]

export default routes
```
å¦‚æ­¤è¿™èˆ¬ï¼Œå„ä¸ªé¡µé¢çš„`title`å°±é¢„è®¾å¥½äº†

å°æ˜ï¼šâ€ä¸ºä»€ä¹ˆ`title`é‡Œä¸åŠ ä¸Šç«™ç‚¹ååç¼€ï¼Ÿåƒ`demo - leenty blog`è¿™æ ·ï¼Ÿâ€œ
è€å¸ˆï¼šâ€œæ»šå‡ºå»ï¼â€

å…¶å®æ˜¯è¿™æ ·çš„ï¼Œåç¼€å¦‚æœä¸€ä¸ªä¸ªåŠ ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä½†ä¸ºä»€ä¹ˆä¸ç”¨è¯­å¥å¸®æˆ‘ä»¬åŠ ä¸Šå»å‘¢ï¼Ÿ
è¿™æ ·å°±ä¸€åŠ³æ°¸é€¸å•¦ï¼Œå†ä¹Ÿä¸ç”¨è‡ªå·±ä¸€ä¸ªä¸ªæ‰“åç¼€äº†ï¼Œå“ˆå“ˆå“ˆï¼ŒçœŸTMæœºæ™ºï¼
![mdzz](http://www.leenty.com/img/vue/mdzz.jpg)

#### è·¯ç”±å¯¼èˆªé’©å­ä»‹ç»
è®²ä¸€è®²è¿™ä¸ªæ‰€è°“çš„å…¨å±€å¯¼èˆªé’©å­ï¼Œå¬èµ·æ¥ç„ä¸æ„£ç™»çš„ã€‚ã€‚ã€‚

å¯¼èˆªæ˜¯å‘ç”Ÿåœ¨è·¯ç”±æ”¹å˜æ—¶çš„äº‹ä»¶ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä½•ç½‘é¡µçš„å¯¼èˆªæ¡å«å¯¼èˆªæ¡çš„åŸå› 
å°¤å¤§å¤§çš„åŸè¯æ˜¯ï¼šâ€œæ­£å¦‚å…¶åï¼Œvue-router æä¾›çš„å¯¼èˆªé’©å­ä¸»è¦ç”¨æ¥æ‹¦æˆªå¯¼èˆªï¼Œè®©å®ƒå®Œæˆè·³è½¬æˆ–å–æ¶ˆã€‚æœ‰å¤šç§æ–¹å¼å¯ä»¥åœ¨è·¯ç”±å¯¼èˆªå‘ç”Ÿæ—¶æ‰§è¡Œé’©å­ï¼šå…¨å±€çš„, å•ä¸ªè·¯ç”±ç‹¬äº«çš„, æˆ–è€…ç»„ä»¶çº§çš„â€
è¯´çš„å¾ˆæ˜ç™½ï¼Œè¨€ç®€æ„èµ…ï¼Œå…¶å®å°±æ˜¯èƒ½è®©ä½ æ§åˆ¶å¯¼èˆªçš„ä¸€ä¸ªæ–¹æ³•è€Œå·²
å¯¼èˆªé’©å­åˆ†ä¸ºå…¨å±€ï¼Œå•ä¸ªè·¯ç”±ç‹¬äº«å’Œç»„ä»¶çº§åˆ«çš„ã€‚
ä½†ä¸è®ºå¦‚ä½•ï¼Œå¯¼èˆªé’©å­éƒ½æ¥å—ä¸€ä¸ªå‡½æ•°ä¸ºå‚æ•°ï¼Œå¹¶ä¼šåœ¨å¯¼èˆªè¿‡ç¨‹ä¸­è°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚
å‡½æ•°ä¼šè¢«ä¼ å…¥3ä¸ªå‚æ•°ï¼Œåˆ†åˆ«ä¸º`to, from, next`
æ²¡é”™ï¼Œä½ çœ‹å­—é¢æ„æ€åº”è¯¥ç†è§£äº†ä¸ªå¤§æ¦‚ï¼Œå³ï¼š
`from`ï¼šä½ ä»å“ªé‡Œæ¥ï¼Ÿ(é—®è¯¢æ¶ˆæ¯çš„å°å¼ŸA)
`to`ï¼šè¦åˆ°å“ªé‡Œå»ï¼Ÿ(é—®è¯¢æ¶ˆæ¯çš„å°å¼ŸB)
`next`ï¼šè®©ä¸è®©è¿‡å»è¿˜å¾—çœ‹è€å­æˆ‘çš„ï¼(å¤§å“¥ä½ æ‡‚ä¸)

ä¸Šé¢è¿™ä½å¤§å“¥(`next`)ä¼šæœ‰ä¸‰ä¸­æ–¹æ³•ï¼
```js
next() // é»˜è®¤é€šè¿‡è·¯ç”±
next(false) // ä¸­æ­¢å¯¼èˆªï¼Œé‚£ä¹ˆå°†ä¼šè·³å›åˆ°fromçš„åœ°å€
next({ path: '/' }) // è·Ÿä¸€ä¸ªè·¯ç”±å‚æ•°å¯¹è±¡ï¼Œå°†ä¼šä¸­æ­¢å½“å‰å¯¼èˆªå¹¶è·³å¾€æŒ‡å‘çš„è·¯ç”±
```

å¥½çš„ï¼Œå…ˆçœ‹çœ‹å…¨å±€çš„å†™æ³•
**å…¨å±€å¯¼èˆªé’©å­**ä¸€å…±ä¸¤ä¸ªï¼Œ`router.beforeEach`å’Œ`router.afterEach`
ä¸€ä¸ªè§¦å‘äºå¯¼èˆªå¼€å§‹å‰ï¼Œä¸€ä¸ªè§¦å‘äºå¯¼èˆªå¼€å§‹åã€‚ç”¨æ³•å‘¢ï¼Œéƒ½æ˜¯ä¸€æ ·çš„ï¼Œå¦‚ä¸‹ï¼
```js
const router = new VueRouter({ ... })

router.beforeEach((to, from, next) => {
  console.log('å°å¼ŸBï¼šå“å‘€å¦ˆå‘€ï¼å¤§å…„å¼Ÿï¼Œè¿™æ˜¯è¦å»å“ªå‘€ï¼Ÿ', to)
  console.log('å°å¼ŸAï¼šå¤§å…„å¼Ÿï¼Œå“ªå„¿æ—®æ²“çš„å‘€ï¼', from)
  next(false) // å¤§å“¥ï¼šè°è®©ä½ è¿‡å»çš„ï¼Ÿ
  // è°ƒç”¨next(false)ä¸­æ­¢å¯¼èˆªï¼Œäºæ˜¯é¡µé¢å›åˆ°è·³è½¬å‰
})

router.afterEach((to, from, next) => {
  console.log('å°å¼ŸBï¼šå“å‘€å¦ˆå‘€ï¼å¤§å…„å¼Ÿï¼Œè¿™æ˜¯è¦å»å“ªå‘€ï¼Ÿ', to)
  console.log('å°å¼ŸAï¼šå¤§å…„å¼Ÿï¼Œå“ªå„¿æ—®æ²“çš„å‘€ï¼', from)
  next() // å¤§å“¥ï¼šè¿‡å»å§ï¼
  // è°ƒç”¨nexté€šè¿‡è·¯ç”±
})
``

**å•ä¸ªè·¯ç”±ç‹¬äº«çš„é’©å­**ï¼ŒåŒæ ·æ˜¯ä¸¤ä¸ªæ–¹æ³•`beforeEnter`å’Œ`afterEnter`ï¼ŒåŒæ ·çš„å¥—è·¯ã€‚
å¥—è·¯å¦‚ä¸‹ï¼š
```js
const router = new VueRouter({
  routes: [
    {
      path: '/demo',
      component: Demo,
      beforeEnter: (to, from, next) => {
        console.log('å°å¼ŸBï¼šå“å‘€å¦ˆå‘€ï¼å¤§å…„å¼Ÿï¼Œè¿™æ˜¯è¦å»å“ªå‘€ï¼Ÿ', to)
        console.log('å°å¼ŸAï¼šå¤§å…„å¼Ÿï¼Œå“ªå„¿æ—®æ²“çš„å‘€ï¼', from)
        next() // å¤§å“¥ï¼šè¿‡å»å§ï¼
        // è°ƒç”¨nexté€šè¿‡è·¯ç”±
      },
      afterEnter: (to, from, next) => {
        console.log('å°å¼ŸBï¼šå“å‘€å¦ˆå‘€ï¼å¤§å…„å¼Ÿï¼Œè¿™æ˜¯è¦å»å“ªå‘€ï¼Ÿ', to)
        console.log('å°å¼ŸAï¼šå¤§å…„å¼Ÿï¼Œå“ªå„¿æ—®æ²“çš„å‘€ï¼', from)
        next({ path: '/' }) // å¤§å“¥ï¼šåƒé‚£è¾¹èµ°ï¼
        // è°ƒç”¨next({ path: '/' })ä¸­æ­¢å¯¼èˆªï¼Œå¹¶è·³åˆ°é¦–é¡µ
      }
    }
  ]
})
```

**ç»„ä»¶å†…çš„é’©å­**ï¼Œä¾ç„¶æ˜¯ä¸€å¯¹åŸºå‹æ–¹æ³•`beforeRouteEnter`å’Œ`beforeRouteLeave`
å¥—è·¯è¿˜æ˜¯ä¸€æ ·çš„0.0
```js
const Demo = {
  template: `<div>this is a Demo </div>`,
  beforeRouteEnter (to, from, next) {
    console.log('å°å¼ŸBï¼šå“å‘€å¦ˆå‘€ï¼å¤§å…„å¼Ÿï¼Œè¿™æ˜¯è¦å»å“ªå‘€ï¼Ÿ', to)
    console.log('å°å¼ŸAï¼šå¤§å…„å¼Ÿï¼Œå“ªå„¿æ—®æ²“çš„å‘€ï¼', from)
    next() // å¤§å“¥ï¼šè¿‡å»å§ï¼
    // åœ¨æ¸²æŸ“è¯¥ç»„ä»¶çš„å¯¹åº”è·¯ç”±è¢« confirm å‰è°ƒç”¨
    // ä¸ï¼èƒ½ï¼è·å–ç»„ä»¶å®ä¾‹ `this`
    // å› ä¸ºå½“é’©å­æ‰§è¡Œå‰ï¼Œç»„ä»¶å®ä¾‹è¿˜æ²¡è¢«åˆ›å»º
  },
  beforeRouteLeave (to, from, next) {
    console.log('å°å¼ŸBï¼šå“å‘€å¦ˆå‘€ï¼å¤§å…„å¼Ÿï¼Œè¿™æ˜¯è¦å»å“ªå‘€ï¼Ÿ', to)
    console.log('å°å¼ŸAï¼šå¤§å…„å¼Ÿï¼Œå“ªå„¿æ—®æ²“çš„å‘€ï¼', from)
    next() // å¤§å“¥ï¼šè¿‡å»å§ï¼
    // å¯¼èˆªç¦»å¼€è¯¥ç»„ä»¶çš„å¯¹åº”è·¯ç”±æ—¶è°ƒç”¨
    // å¯ä»¥è®¿é—®ç»„ä»¶å®ä¾‹ `this`
  }
}
```

#### é…åˆè·¯ç”±å…¨å±€å¯¼èˆªé’©å­å»æ›´æ–°`title`
å¥½çš„ï¼Œä¸‰ç§éƒ½ä»‹ç»å®Œäº†ï¼Œé‚£ä¹ˆæ‰“å¼€`src/router.js`ï¼Œæ²¡é”™ï¼Œè¿™å›æ˜¯`router.js`ï¼Œè¿™æ˜¯å’±è£…è½½è·¯ç”±çš„æ–‡ä»¶

åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬è¿˜éœ€è¦çŸ¥é“åœ¨ä¸€ä¸ªåµŒå¥—è·¯ç”±æƒ…å†µä¸‹çš„èŠ‚ç‚¹åˆ†å¸ƒã€‚
ä¸‰ä¸ªå‚æ•°ä¹‹ä¸€çš„`to`å­˜åœ¨å±æ€§`to.matched`,é‡Œé¢å­˜åœ¨äº†ä¸€ä¸ªåŒ…å«è·¯ç”±èŠ‚ç‚¹çš„æ•°ç»„
é¡ºåºæ˜¯ä»å­è·¯ç”±åˆ°æ ¹è·¯ç”±

å¥½çš„ï¼Œç¡®å®šä¸‹titleæ–‡æ¡ˆ

router             | title
:----------------- | :-----:
`â”œâ”€â”€ home         `| leenty blog
`â”œâ”€â”€ article      `| article - leenty blog
`â”‚   â”œâ”€â”€ vue2-1   `| vue2.0ä¸€èµ·åœ¨æ‡µé€¼çš„æµ·æ´‹é‡Œè¶Šé™·è¶Šæ·±ï¼ˆä¸€ï¼‰ - article - leenty blog
`â”‚   â”œâ”€â”€ ...      `| ... - article - leenty blog
`â”‚   â””â”€â”€ vue2-6   `| vue2.0ä¸€èµ·åœ¨æ‡µé€¼çš„æµ·æ´‹é‡Œè¶Šé™·è¶Šæ·±ï¼ˆå…­ï¼‰ - article - leenty blog
`â””â”€â”€ demo         `| demo - leenty blog
`    â””â”€â”€ demo-1   `| å…·ä½“æ¼”ç¤º1 - demo - leenty blog

é‡Œé¢çš„ç»“æ„æ˜¯è¿™æ ·çš„
```js
import Vue from 'vue'
import VueRouter from 'vue-router'
import routes from './routes'

const title = 'leenty blog'
// å®šä¹‰æˆ‘ä»¬ç«™ç‚¹çš„åå­—

Vue.use(VueRouter)

/* eslint-disable no-new */
const router = new VueRouter({
  mode: 'history',
  linkActiveClass: 'u-link--Active',
  routes
})

// è·¯ç”±å¯¼èˆªé’©å­ï¼ŒbeforeEachï¼Œåœ¨è·¯ç”±è¿›å…¥å‰è°ƒç”¨
router.beforeEach((to, from, next) => {
  let titleStr = ''
  // æ£€æµ‹æ˜¯ä¸æ˜¯è¦è·³è½¬é¦–é¡µï¼Œå¦‚æœæ˜¯ï¼Œåˆ™ä¸å¤„ç†
  if (to.name !== 'Home') {
    // å€’åºéå†æ•°ç»„è·å–åŒ¹é…åˆ°çš„è·¯ç”±èŠ‚ç‚¹ï¼Œæ‹¼æ¥å„éƒ¨åˆ†title
    for (let i = to.matched.length - 1; i >= 0; i--) {
      titleStr += `${to.matched[i].meta.title} - `
    }
  }
  // æ·»åŠ ç«™ç‚¹å
  titleStr += title
  // æ›´æ–°title
  document.title = titleStr
  // ç»§ç»­è·¯ç”±å¯¼èˆª
  next()
})

export default router
```

okï¼Œæ‰“å®Œæ”¶å·¥ï¼ç°åœ¨å¯ä»¥åˆ‡æ¢è·¯ç”±çœ‹çœ‹`title`æœ‰æ²¡æœ‰åœ¨å˜åŒ–äº†ã€‚
å¯ä»¥çœ‹æˆ‘çš„Demo[http://vue2.leenty.com](http://vue2.leenty.com)ï¼Œå››å¤„åˆ‡æ¢è·¯ç”±ï¼Œçœ‹çœ‹æ ‡é¢˜å¦‚ä½•å˜åŒ–å§ï¼

### å…¶ä»–
[æ¼”ç¤ºåœ°å€(http://vue2.leenty.com)](http://vue2.leenty.com)
[æºç åœ°å€(https://github.com/leenty/vue2)](https://github.com/leenty/vue2)
[githubä¸»é¡µ](https://github.com/leenty),è§‰å¾—é è°±çš„è¯æ¬¢è¿åŠ æ˜Ÿè·Ÿéš



